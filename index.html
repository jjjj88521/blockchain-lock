<!DOCTYPE html>
<html>
	
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<link href="https://fonts.googleapis.com/css?family=Noto+Sans+TC|Open+Sans&display=swap" rel="stylesheet">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="https://apps.bdimg.com/libs/jquerymobile/1.4.5/jquery.mobile-1.4.5.min.css">
    	<script src="https://apps.bdimg.com/libs/jquery/1.10.2/jquery.min.js"></script>
		<script src="https://apps.bdimg.com/libs/jquerymobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
		<link rel="stylesheet" href="http://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  		<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  		<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="stylesheet" href="css/style.css">
		<!-- title -->
		<title>區塊鏈智慧鎖</title>

		<script src="node_modules/web3/dist/web3.js"></script>
		<link rel="stylesheet" href="magnific-popup/magnific-popup.css">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
	</head>
	
	<body>
		
        <!-- <header>
	        <div class='container'>
				<nav class="navbar navbar-expand-lg navbar-light">
				  <a class="navbar-brand" href="PayToRoom.html"><img src='HOUSE.png' width='60'></a>
				  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				    <span class="navbar-toggler-icon"></span>
				  </button>
				
				  <div class="collapse navbar-collapse" id="navbarSupportedContent">
				    <ul class="navbar-nav mr-auto">
				      <li class="nav-item">
				        <a class="nav-link" href="index.html">主頁</a>
				      </li>
				      <li class="nav-item">
				        <a class="nav-link" href="all.html">租房</a>
				      </li>
				      <li class="nav-item">
				        <a class="nav-link" href="faq.html">我的訂單</a>
				      </li>	
				      <li class="nav-item">
				        <a class="nav-link" href="contact.html">帳戶專區</a>
				      </li>			
				    </ul>
				  
				  </div>
				</nav>
	        </div>
				</header> -->
				
				<section id='intro'>
			
						<div class="jumbotron">
							<div class='container'>
								<div class='row'>
									<div class='col-md-12'>
											<h1 class="display-4">區塊鏈智慧鎖</h1>
											<p class="lead">BlockChain Smart Lock</p>
											<a class="btn btn-primary btn-lg" 
												href="#myPopup" 
												data-rel="popup" 
												data-position-to="window" 
												button id="login">登入</a>
											<a class="btn btn-primary btn-lg" 
												href="#myPopuptwo" 
												data-rel="popup" 
												data-position-to="window" 
												button id="login">註冊</a><br><br>
											<p  class="lead" id="username"></p>
											<p  class="lead" id="useraddress"></p>
											<p  class="lead" id="userbalance"></p>
									</div>
								</div>
							</div>
						</div>	
							
					</section>
					<div data-role="popup" id="myPopup" data-overlay-theme="b" class="ui-content" style="min-width:250px;">
								<div>
									<h3>登入訊息</h3>									
									<input type="text" id="loginusername" placeholder="使用者名稱">
									<input type="password" id="loginpasswd" placeholder="密碼">
									<button id="loginuser" onclick = login()>登入</button>
									<p id="loginmessage"></p>
								</div>
					</div>

					<div data-role="popup" id="myPopuptwo" data-overlay-theme="b" class="ui-content" style="min-width:250px;">
							<div>
								<h3>註冊訊息</h3>
								<input type="text" id="registerusername" placeholder="使用者名稱">
								<input type="password" id="registerpasswd" placeholder="密碼">
								<button id="registeruser" onclick = register()>註冊</button>
								<p id="registeraddress"></p>
							</div>
				  </div>
					
        <section id='latest'>
	        
	        <div class="container">
		        <div class='row'>
					  <div class='col-md-12 text-center'>
					  	<h3>所有裝置</h3>
					  	<div class='row'>
						  	<div class='col-md-4 text-left'>
							  	<div class='outer'>								  	
									  	<div class='upper'>
											<!-- <img src='Yayi1.jpg'> -->
									  	</div>
									  	<div class='lower'>										
												<h3>裝置1</h3>
											<span><i class="far fa-clock"></i><input type="number" min="1" max="5" id="date1" placeholder = "輸入預約時間(1~5分鐘)"><br></span>
											<span><a class="btn btn-primary btn-lg" href="#myPopupconfirmONE" data-rel="popup" data-position-to="window" button id="addcontract">預約</a></span>
											<span><a class="btn btn-primary btn-lg" href="#myPopupcancel1" data-rel="popup" data-position-to="window" button id="cancelcontract">取消預約</a></span>
											<button id="getqrcodeBTNONE" onclick = GetQRcodeONE()>QRcode</button>
									  	</div>
							  	</div>
						  	</div>
						  	<div class='col-md-4 text-left'>
							  	<div class='outer'>
									  	<div class='upper'>
									  	</div>
									  	<div class='lower'>
												<h3>裝置2</h3>
											<span><i class="far fa-clock"></i><input type="number" min="1" max="5" id="date2" placeholder = "輸入預約時間(1~5分鐘)"><br></span>
											<span><a class="btn btn-primary btn-lg" href="#myPopupconfirmTWO" data-rel="popup" data-position-to="window" button id="addcontract">預約</a></span>
											<span><a class="btn btn-primary btn-lg" href="#myPopupcancel2" data-rel="popup" data-position-to="window" button id="cancelcontract">取消預約</a></span>
											<button id="getqrcodeBTNONE" onclick = GetQRcodeTWO()>QRcode</button>
									  	</div>
							  	</div>
						  	</div>
						  	<!-- <div class='col-md-4 text-left'>
							  	<div class='outer'>
									  	<div class='upper'> -->
									  	<!-- </div>
									  	<div class='lower'>
												<h3>裝置3</h3>												
											<span><i class="far fa-clock"></i><input type="text" id="date4" placeholder = "輸入預約時間"><br></span>
											<span><a class="btn btn-primary btn-lg" href="#myPopupconfirmFOUR" data-rel="popup" data-position-to="window" button id="addcontract"onclick=confirmFOUR()>預約</a></span>
											<span><a class="btn btn-primary btn-lg" href="#myPopupcancel3" data-rel="popup" data-position-to="window" button id="cancelcontract" onclick=confirmONE()>取消預約</a></span>
									  	</div>
							  	</div>
						  	</div>						 -->
					  	</div>
					  </div>
			    <div>
	        </div>
			<!-- 確認預約 -->
			<div data-role="popup" id="myPopupconfirmONE" data-overlay-theme="b" class="ui-content" style="min-width:250px;">
				<div>
				  <h3>確認預約</h3>
				  <p>裝置1</p>
				  <p id="dateONE"></p>
				  <button id="confirmroomcontrolBTN" onclick = PayONE()>付款</button>
				  <button id="close">關閉</button>
				  <p id="qrcodeONE"></p>
				  <p id="paydateONE"></p>
				</div>
			</div>

			<div data-role="popup" id="myPopupconfirmTWO" data-overlay-theme="b" class="ui-content" style="min-width:250px;">
				<div>
				  <h3>確認預約</h3>
				  <p>裝置2</p>
				  <p id="dateTWO"></p>
				  <button id="confirmroomcontrolBTN" onclick = PayTWO()>付款</button>
				  <button id="close">關閉</button>
				  <p id="qrcodeTWO"></p>
				  <p id="paydateTWO"></p>
				</div>
			</div>
			
			<!-- <div data-role="popup" id="myPopupconfirmFOUR" data-overlay-theme="b" class="ui-content" style="min-width:250px;">
				<div>
				  <h3>確認預約</h3>
				  <p>裝置3</p>
				  <p id="dateFOUR"></p>
				  <button id="confirmroomcontrolBTN" onclick = PayFOUR()>付款</button>
				  <button id="cancel1" onclick = CancelFOUR()>取消</button>
				  <p id="qrcodeFOUR"></p>
				  <p id="paydateFOUR"></p>
				</div>
			</div> -->

			<!-- 取消預約 -->
			<div data-role="popup" id="myPopupcancel1" data-overlay-theme="b" class="ui-content" style="min-width:250px;">
				<div>
				  <h3>取消預約</h3>
				  <p>裝置1</p>
				  <p id="dateONE"></p>
				  <button id="confirmroomcontrolBTN" onclick = Cancel()>確認</button>
				  <button id="close">關閉</button>
				  <p id="qrcodeONE"></p>
				  <p id="paydateONE"></p>
				</div>
			</div>

			<div data-role="popup" id="myPopupcancel2" data-overlay-theme="b" class="ui-content" style="min-width:250px;">
				<div>
				  <h3>取消預約</h3>
				  <p>裝置2</p>
				  <p id="dateTWO"></p>
				  <button id="confirmroomcontrolBTN" onclick = Cancel()>確認</button>
				  <button id="close">關閉</button>
				  <p id="qrcodeONE"></p>
				  <p id="paydateONE"></p>
				</div>
			</div>

			<!-- <div data-role="popup" id="myPopupcancel3" data-overlay-theme="b" class="ui-content" style="min-width:250px;">
				<div>
				  <h3>取消預約</h3>
				  <p>裝置3</p>
				  <p id="dateFOUR"></p>
				  <button id="confirmroomcontrolBTN" onclick = PayFOUR()>確認</button>
				  <button id="cancel3" onclick = CancelFOUR()>取消</button>
				  <p id="qrcodeONE"></p>
				  <p id="paydateONE"></p>
				</div>
			</div> -->

        </section>      
		
				<script>
						

						//連結私有鏈
						if (typeof web3 !== 'undefined') {
								 web3 = new Web3(web3.currentProvider);
						 } else {
								 // set the provider you want from Web3.providers
								 web3 = new Web3(new Web3.providers.HttpProvider("http://134.208.3.201:1225"));
						 }

						 //設定AccountManagement合約
						 var AccountManagementABI = web3.eth.contract([{"constant":true,"inputs":[{"name":"_username","type":"string"}],"name":"CheckAccount","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_LightQR","type":"bytes32"}],"name":"RestoreSettings","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[],"name":"sendcontrolbalance","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_LightQR","type":"bytes32"}],"name":"controlQR","outputs":[{"name":"","type":"bool"},{"name":"","type":"string"},{"name":"","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_user","type":"address"}],"name":"withdraw","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_username","type":"string"},{"name":"_useraddress","type":"address"}],"name":"NewAccount","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_Lightnumber","type":"string"}],"name":"getRentStatus","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"getinformation","outputs":[{"name":"","type":"string"},{"name":"","type":"string"},{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_user","type":"address"},{"name":"_Lightnumber","type":"string"},{"name":"_rentedtime","type":"string"}],"name":"paytolight","outputs":[{"name":"","type":"bool"},{"name":"","type":"bytes32"}],"payable":true,"stateMutability":"payable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"orderaddress","type":"address"},{"indexed":false,"name":"orderlight","type":"string"},{"indexed":false,"name":"time","type":"string"},{"indexed":false,"name":"orderstatus","type":"string"}],"name":"Order","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"canceladdress","type":"address"},{"indexed":false,"name":"cancelstatus","type":"string"}],"name":"Cancel","type":"event"}]);
						 var AccountManagement = AccountManagementABI.at('0xB8Cd20849d98ba6c67Daf8d0EdA8AcCb330616A7');
						 console.log(AccountManagement);

						 var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
			 
						 //註冊帳戶->加入到AccountManagement合約做儲存
						 async function register(){
							 var test = $("#registerpasswd").val();
							 var userwalletaddress = web3.personal.newAccount(test);
							 $('#registeraddress').html(userwalletaddress);
							 AccountManagement.NewAccount($("#registerusername").val(),$("#registeraddress").html(),{from:web3.eth.accounts[0]});
						 }

						 //登入帳戶->取得帳戶資訊
						 async function login(){
							 var passwd = $("#loginpasswd").val();
							 var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
							 $('#loginmessage').html(web3.personal.unlockAccount(userwalletaddress,passwd));
							 if(web3.personal.unlockAccount(userwalletaddress,passwd)==true){     
								$('#username').html("User : " + $("#loginusername").val());
								$('#useraddress').html("Wallet Address : " + userwalletaddress);
								$('#userbalance').html("Wallet Balance : " + web3.fromWei(web3.eth.getBalance(userwalletaddress),'ether'));
							 }
						 }
						 //設定門禁合約
						 var PayToRoomABI = web3.eth.contract([{"constant":false,"inputs":[{"name":"_user","type":"address"},{"name":"_Lightnumber","type":"string"},{"name":"_rentedtime","type":"string"}],"name":"PayToLight","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[{"name":"_LightQR","type":"bytes32"}],"name":"controlLight","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_username","type":"string"}],"name":"CheckAccount","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"sendcontrolbalance","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_Lightnumber","type":"string"}],"name":"getrentstatus","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_LightQR","type":"bytes32"}],"name":"getlightnumber","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"isOrder","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_username","type":"string"},{"name":"_useraddress","type":"address"}],"name":"NewAccount","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"getQRcode","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"isopenlight","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"getinformation","outputs":[{"name":"","type":"string"},{"name":"","type":"string"},{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_Lightnumber","type":"string"}],"name":"restoresettings","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_LightQR","type":"bytes32"}],"name":"getlighttime","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"isWithdraw","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_user","type":"address"}],"name":"Withdraw","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"orderaddress","type":"address"},{"indexed":false,"name":"orderlight","type":"string"},{"indexed":false,"name":"time","type":"string"},{"indexed":false,"name":"orderstatus","type":"string"}],"name":"Order","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"canceladdress","type":"address"},{"indexed":false,"name":"cancelstatus","type":"string"}],"name":"Cancel","type":"event"}]);
						 var PayToRoom = PayToRoomABI.at('0xA42f64D78Ac72e593527DB47B704EB366B89E289');
						 console.log(PayToRoom);

						 var i;
						//  var dates1 = []; 
						//設定預約時間
						// function DisableDates1(date) {
						// 	var string = jQuery.datepicker.formatDate('yy/mm/dd', date);
						// 	return [dates1.indexOf(string) == -1];
						// }
						//  $(function() {
						// 	$("#date1").datepicker({
						// 		beforeShowDay: DisableDates1,
						// 		dateFormat: 'yy/mm/dd'
						// 	});
						//  });
						function Cancel(){
						 	var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
						 	PayToRoom.Withdraw(userwalletaddress, {from:userwalletaddress,gas:200000,gasPrice:21000});
						}
						// 	for(i=0;i<dates1.length;i++){
						// 		if(dates1[i]==$('#date1').val()){
						// 			delete dates1[i];
						// 		}
						// 	}
						// }

						// var dates2 = []; 
						// function DisableDates2(date) {
						// 	var string = jQuery.datepicker.formatDate('yy/mm/dd', date);
						// 	return [dates2.indexOf(string) == -1];
						// }
						//  $(function() {
						// 	$("#date2").datepicker({
						// 		beforeShowDay: DisableDates2,
						// 		dateFormat: 'yy/mm/dd'
						// 	});
						//  });
						// function CancelTWO(){
						// 	var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
						// 	PayToRoom.OrderCancel($('#date2').val(),"room2",{from:userwalletaddress,gas:200000,gasPrice:21000});
						// 	for(i=0;i<dates2.length;i++){
						// 		if(dates2[i]==$('#date2').val()){
						// 			delete dates2[i];
						// 		}
						// 	}
						// }

						// var dates4 = []; 
						// function DisableDates4(date) {
						// 	var string = jQuery.datepicker.formatDate('yy/mm/dd', date);
						// 	return [dates4.indexOf(string) == -1];
						// }
						//  $(function() {
						// 	$("#date4").datepicker({
						// 		beforeShowDay: DisableDates4,
						// 		dateFormat: 'yy/mm/dd'
						// 	});
						//  });
						//  function CancelFOUR(){
						// 	for(i=0;i<dates4.length;i++){
						// 		var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
						// 		PayToRoom.OrderCancel($('#date4').val(),"room4",{from:userwalletaddress,gas:200000,gasPrice:21000});
						// 		if(dates4[i]==$('#date4').val()){
						// 			delete dates4[i];
						// 		}
						// 	}
						// }

						 //var getQR = PayToRoom.getQR();

						//  function confirmONE(){
						// 	var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
						// 	PayToRoom.Orderprocessing($('#date1').val(),"room1",{from:userwalletaddress,gas:200000,gasPrice:21000});
						// 	dates1.push($('#date1').val());
						// 	$('#dateONE').html($('#date1').val());
						//  }
						 
						//  function confirmTWO(){
						// 	var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
						// 	PayToRoom.Orderprocessing($('#date2').val(),"room2",{from:userwalletaddress,gas:200000,gasPrice:21000});
						// 	dates2.push($('#date2').val());
						// 	$('#dateTWO').html($('#date2').val());
						//  }

						//  function confirmFOUR(){
						// 	var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
						// 	PayToRoom.Orderprocessing($('#date4').val(),"room4",{from:userwalletaddress,gas:200000,gasPrice:21000});
						// 	dates4.push($('#date4').val());
						// 	$('#dateFOUR').html($('#date4').val());
						//  }

						 function PayONE(){
							 var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
							 var time = $('#date1').val();
							 var time_string = $('#date1').val().toString();
							 PayToRoom.paytoroom(userwalletaddress, "1", time_string, {from:userwalletaddress,value:web3.toWei(time,"ether"),gas:200000,gasPrice:21000});
						 }

						 /*$("#confirmroomcontrolBTN").click(function() {
							 var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
							 PayToRoom.paytoroom("room1", $("#dateONE").val(),userwalletaddress,{from:userwalletaddress,value:web3.toWei(1,"ether")});
						 });*/

						 function PayTWO(){
							 var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
							 var time = $('#date1').val()
							 var time_string = $('#date1').val().toString();
							 PayToRoom.paytoroom(userwalletaddress, "2", time_string, {from:userwalletaddress,value:web3.toWei(time,"ether"),gas:200000,gasPrice:21000});
						 }

						 

						//  function PayFOUR(){
						// 	 var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
						// 	 PayToRoom.paytoroom("room4",$('#date4').val(),userwalletaddress,{from:userwalletaddress,value:web3.toWei(4,"ether"),gas:200000,gasPrice:21000});
						//  }

						 function GetQRcodeONE(){
							 var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
							 $("#qrcodeONE").html(PayToRoom.controlQR("room1",$('#date1').val(),userwalletaddress,{from:userwalletaddress,gas:200000}));
							 //var url = "https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=" + textQR + "&choe=UTF-8&chld=M|2";
							 //var qr_code = "<img alt='Your QRcode' src='" + url + "' />";
							 //$("#qrcodeONE").html(qr_code);
						 }

						 function GetQRcodeTWO(){
							 var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
							 $("#qrcodeTWO").html(PayToRoom.controlQR("room2",$('#date2').val(),userwalletaddress,{from:userwalletaddress,gas:200000}));
						 }

						 function GetQRcodeFOUR(){
							 var userwalletaddress = AccountManagement.CheckAccount($("#loginusername").val());
							 $("#qrcodeFOUR").html(PayToRoom.controlQR("room4",$('#date4').val(),userwalletaddress,{from:userwalletaddress,gas:200000}));
						 }

						 getQR.watch(function(error,result){
							if (!error)
								{
									$("#loader").hide();
									var textQR = result.args.qr;
									var url = "https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=" + textQR + "&choe=UTF-8&chld=M|2";
									var qr_code = "<img alt='Your QRcode' src='" + url + "' />";
									$("#qrcodeONE").html(qr_code);
								} else {
									$("#loader").hide();
									console.log(error);
								}
						})





				</script>

				
	</body>	
</html>